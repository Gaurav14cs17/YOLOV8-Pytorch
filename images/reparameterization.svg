<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 500">
  
  <!-- Light cream background -->
  <rect width="1200" height="500" fill="#F5F5DC"/>
  
  <!-- Title -->
  <text x="600" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#333">Structural Reparameterization</text>
  <text x="600" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#666">Multi-branch fusion into single convolution</text>
  
  <!-- ==================== TRAINING ==================== -->
  <rect x="30" y="90" width="420" height="380" rx="15" fill="#E0F4F4" stroke="#5DADE2" stroke-width="2"/>
  <text x="240" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1A5276">Training</text>
  
  <!-- Input -->
  <rect x="190" y="145" width="100" height="35" rx="5" fill="#F4D03F" stroke="#D4AC0D" stroke-width="2"/>
  <text x="240" y="168" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Input</text>
  
  <!-- Split line -->
  <line x1="240" y1="180" x2="240" y2="205" stroke="#555" stroke-width="2"/>
  <line x1="70" y1="205" x2="410" y2="205" stroke="#555" stroke-width="2"/>
  
  <!-- Vertical lines to branches -->
  <line x1="70" y1="205" x2="70" y2="230" stroke="#555" stroke-width="2"/>
  <line x1="155" y1="205" x2="155" y2="230" stroke="#555" stroke-width="2"/>
  <line x1="240" y1="205" x2="240" y2="230" stroke="#555" stroke-width="2"/>
  <line x1="325" y1="205" x2="325" y2="230" stroke="#555" stroke-width="2"/>
  <line x1="410" y1="205" x2="410" y2="230" stroke="#555" stroke-width="2"/>
  
  <!-- Branch 1: 7×7 -->
  <rect x="45" y="230" width="50" height="40" rx="5" fill="#E74C3C" stroke="#B03A2E" stroke-width="2"/>
  <text x="70" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#FFF">7×7</text>
  <rect x="50" y="280" width="40" height="25" rx="4" fill="#3498DB" stroke="#2471A3" stroke-width="1"/>
  <text x="70" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#FFF">BN</text>
  
  <!-- Branch 2: 5×5 -->
  <rect x="130" y="230" width="50" height="40" rx="5" fill="#E67E22" stroke="#CA6F1E" stroke-width="2"/>
  <text x="155" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#FFF">5×5</text>
  <rect x="135" y="280" width="40" height="25" rx="4" fill="#3498DB" stroke="#2471A3" stroke-width="1"/>
  <text x="155" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#FFF">BN</text>
  
  <!-- Branch 3: 3×3 -->
  <rect x="215" y="230" width="50" height="40" rx="5" fill="#F1C40F" stroke="#D4AC0D" stroke-width="2"/>
  <text x="240" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#333">3×3</text>
  <rect x="220" y="280" width="40" height="25" rx="4" fill="#3498DB" stroke="#2471A3" stroke-width="1"/>
  <text x="240" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#FFF">BN</text>
  
  <!-- Branch 4: 1×1 -->
  <rect x="300" y="230" width="50" height="40" rx="5" fill="#2ECC71" stroke="#27AE60" stroke-width="2"/>
  <text x="325" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#FFF">1×1</text>
  <rect x="305" y="280" width="40" height="25" rx="4" fill="#3498DB" stroke="#2471A3" stroke-width="1"/>
  <text x="325" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#FFF">BN</text>
  
  <!-- Branch 5: Identity -->
  <rect x="385" y="230" width="50" height="40" rx="5" fill="#95A5A6" stroke="#7F8C8D" stroke-width="2"/>
  <text x="410" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#FFF">Id</text>
  <rect x="390" y="280" width="40" height="25" rx="4" fill="#3498DB" stroke="#2471A3" stroke-width="1"/>
  <text x="410" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#FFF">BN</text>
  
  <!-- Lines to sum -->
  <line x1="70" y1="305" x2="70" y2="340" stroke="#555" stroke-width="2"/>
  <line x1="155" y1="305" x2="155" y2="340" stroke="#555" stroke-width="2"/>
  <line x1="240" y1="305" x2="240" y2="340" stroke="#555" stroke-width="2"/>
  <line x1="325" y1="305" x2="325" y2="340" stroke="#555" stroke-width="2"/>
  <line x1="410" y1="305" x2="410" y2="340" stroke="#555" stroke-width="2"/>
  <line x1="70" y1="340" x2="410" y2="340" stroke="#555" stroke-width="2"/>
  <line x1="240" y1="340" x2="240" y2="365" stroke="#555" stroke-width="2"/>
  
  <!-- Sum circle -->
  <circle cx="240" cy="385" r="18" fill="#E74C3C" stroke="#B03A2E" stroke-width="2"/>
  <text x="240" y="391" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FFF">a</text>
  
  <!-- Output (training) -->
  <line x1="240" y1="403" x2="240" y2="430" stroke="#555" stroke-width="2"/>
  <polygon points="235,425 245,425 240,435" fill="#555"/>
  <rect x="190" y="440" width="100" height="35" rx="5" fill="#F4D03F" stroke="#D4AC0D" stroke-width="2"/>
  <text x="240" y="463" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Output</text>
  
  <!-- ==================== ARROW ==================== -->
  <rect x="490" y="200" width="130" height="80" rx="10" fill="#9B59B6" stroke="#7D3C98" stroke-width="2"/>
  <text x="555" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#FFF">FUSE</text>
  <text x="555" y="260" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#FFF">Reparameterize</text>
  
  <!-- Arrow -->
  <polygon points="620,220 620,260 680,240" fill="#9B59B6" stroke="#7D3C98" stroke-width="2"/>
  
  <!-- ==================== INFERENCE ==================== -->
  <rect x="720" y="90" width="450" height="380" rx="15" fill="#FADBD8" stroke="#E74C3C" stroke-width="2"/>
  <text x="945" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#922B21">Inference</text>
  
  <!-- Input (inference) -->
  <rect x="895" y="160" width="100" height="35" rx="5" fill="#F4D03F" stroke="#D4AC0D" stroke-width="2"/>
  <text x="945" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Input</text>
  
  <!-- Arrow down -->
  <line x1="945" y1="195" x2="945" y2="230" stroke="#555" stroke-width="2"/>
  <polygon points="940,225 950,225 945,235" fill="#555"/>
  
  <!-- Single fused conv -->
  <rect x="800" y="240" width="290" height="80" rx="10" fill="#E74C3C" stroke="#B03A2E" stroke-width="2"/>
  <text x="945" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#FFF">7×7 DWConv (Fused)</text>
  <text x="945" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#FFF">W = W₇ + pad(W₅) + pad(W₃) + pad(W₁) + I</text>
  
  <!-- Output (inference) -->
  <line x1="945" y1="320" x2="945" y2="360" stroke="#555" stroke-width="2"/>
  <polygon points="940,355 950,355 945,365" fill="#555"/>
  <rect x="895" y="370" width="100" height="35" rx="5" fill="#F4D03F" stroke="#D4AC0D" stroke-width="2"/>
  <text x="945" y="393" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Output</text>
  
  <!-- Equals sign -->
  <rect x="850" y="420" width="190" height="40" rx="6" fill="#D5F5E3" stroke="#2ECC71" stroke-width="2"/>
  <text x="945" y="446" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1E8449">Same Output ✓</text>
  
  <!-- Benefits -->
  <rect x="750" y="420" width="90" height="40" rx="6" fill="#FEF9E7" stroke="#F39C12" stroke-width="2"/>
  <text x="795" y="446" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#9A7D0A">5× Faster</text>
  
  <rect x="1050" y="420" width="100" height="40" rx="6" fill="#EBE3F3" stroke="#9B59B6" stroke-width="2"/>
  <text x="1100" y="446" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7D3C98">Less Memory</text>
  
  <!-- Legend -->
  <rect x="490" y="320" width="130" height="140" rx="8" fill="#FFF" stroke="#AAA" stroke-width="1"/>
  <text x="555" y="345" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Legend</text>
  
  <circle cx="515" cy="370" r="10" fill="#E74C3C" stroke="#B03A2E" stroke-width="1"/>
  <text x="515" y="374" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#FFF">a</text>
  <text x="565" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Add</text>
  
  <rect x="505" y="390" width="20" height="15" rx="2" fill="#3498DB" stroke="#2471A3" stroke-width="1"/>
  <text x="565" y="403" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">BN</text>
  
  <rect x="505" y="415" width="20" height="15" rx="2" fill="#E74C3C" stroke="#B03A2E" stroke-width="1"/>
  <text x="565" y="428" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Conv</text>
  
  <text x="555" y="450" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">DWConv=Depthwise</text>
  
</svg>
