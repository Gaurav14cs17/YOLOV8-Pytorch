<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1000">
  
  <!-- Light background -->
  <rect width="1800" height="1000" fill="#FAFAFA"/>
  
  <!-- Title -->
  <text x="900" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="36" font-weight="bold" fill="#333">RepNeXt Block — Structural Reparameterization</text>
  
  <!-- ==================== TRAINING MODE (LEFT) ==================== -->
  <rect x="40" y="90" width="750" height="880" rx="16" fill="#E8F6F3" stroke="#1ABC9C" stroke-width="3"/>
  <text x="415" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#117A65">TRAINING</text>
  
  <!-- Input -->
  <rect x="305" y="170" width="220" height="60" rx="10" fill="#F4D03F" stroke="#D4AC0D" stroke-width="3"/>
  <text x="415" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#333">Input (C)</text>
  
  <!-- Skip connection - LEFT SIDE going down -->
  <line x1="305" y1="200" x2="90" y2="200" stroke="#9B59B6" stroke-width="4" stroke-dasharray="12,6"/>
  <line x1="90" y1="200" x2="90" y2="820" stroke="#9B59B6" stroke-width="4" stroke-dasharray="12,6"/>
  <line x1="90" y1="820" x2="390" y2="820" stroke="#9B59B6" stroke-width="4" stroke-dasharray="12,6"/>
  <polygon points="385,812 385,828 400,820" fill="#9B59B6"/>
  <text x="75" y="520" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#9B59B6" writing-mode="tb">Skip Connection</text>
  
  <!-- Down arrow from input -->
  <line x1="415" y1="230" x2="415" y2="275" stroke="#555" stroke-width="3"/>
  <polygon points="407,268 423,268 415,283" fill="#555"/>
  
  <!-- Multi-branch box -->
  <rect x="120" y="290" width="590" height="190" rx="14" fill="#FFF" stroke="#3498DB" stroke-width="3"/>
  <text x="415" y="330" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#2471A3">Multi-Branch Depthwise Convolutions</text>
  
  <!-- 5 branches in a row -->
  <rect x="140" y="355" width="90" height="55" rx="8" fill="#E74C3C" stroke="#B03A2E" stroke-width="2"/>
  <text x="185" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#FFF">7×7</text>
  <rect x="140" y="415" width="90" height="35" rx="6" fill="#3498DB" stroke="#2471A3" stroke-width="2"/>
  <text x="185" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FFF">BN</text>
  
  <rect x="250" y="355" width="90" height="55" rx="8" fill="#E67E22" stroke="#CA6F1E" stroke-width="2"/>
  <text x="295" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#FFF">5×5</text>
  <rect x="250" y="415" width="90" height="35" rx="6" fill="#3498DB" stroke="#2471A3" stroke-width="2"/>
  <text x="295" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FFF">BN</text>
  
  <rect x="360" y="355" width="90" height="55" rx="8" fill="#F1C40F" stroke="#D4AC0D" stroke-width="2"/>
  <text x="405" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">3×3</text>
  <rect x="360" y="415" width="90" height="35" rx="6" fill="#3498DB" stroke="#2471A3" stroke-width="2"/>
  <text x="405" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FFF">BN</text>
  
  <rect x="470" y="355" width="90" height="55" rx="8" fill="#2ECC71" stroke="#27AE60" stroke-width="2"/>
  <text x="515" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#FFF">1×1</text>
  <rect x="470" y="415" width="90" height="35" rx="6" fill="#3498DB" stroke="#2471A3" stroke-width="2"/>
  <text x="515" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FFF">BN</text>
  
  <rect x="580" y="355" width="90" height="55" rx="8" fill="#95A5A6" stroke="#7F8C8D" stroke-width="2"/>
  <text x="625" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#FFF">Identity</text>
  <rect x="580" y="415" width="90" height="35" rx="6" fill="#3498DB" stroke="#2471A3" stroke-width="2"/>
  <text x="625" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FFF">BN</text>
  
  <!-- Plus signs -->
  <text x="237" y="400" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#555">+</text>
  <text x="347" y="400" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#555">+</text>
  <text x="457" y="400" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#555">+</text>
  <text x="567" y="400" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#555">+</text>
  
  <!-- Sum -->
  <line x1="415" y1="480" x2="415" y2="520" stroke="#555" stroke-width="3"/>
  <circle cx="415" cy="545" r="25" fill="#E74C3C" stroke="#B03A2E" stroke-width="3"/>
  <text x="415" y="553" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#FFF">Σ</text>
  
  <!-- LayerNorm -->
  <line x1="415" y1="570" x2="415" y2="605" stroke="#555" stroke-width="3"/>
  <polygon points="407,598 423,598 415,613" fill="#555"/>
  <rect x="290" y="620" width="250" height="55" rx="10" fill="#1ABC9C" stroke="#16A085" stroke-width="3"/>
  <text x="415" y="655" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#FFF">LayerNorm</text>
  
  <!-- MLP Box -->
  <rect x="160" y="700" width="510" height="130" rx="12" fill="#D5F5E3" stroke="#27AE60" stroke-width="3"/>
  <text x="415" y="735" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1E8449">Channel Mixer (MLP)</text>
  <line x1="415" y1="675" x2="415" y2="755" stroke="#555" stroke-width="3"/>
  <rect x="210" y="755" width="410" height="45" rx="8" fill="#27AE60" stroke="#1E8449" stroke-width="2"/>
  <text x="415" y="785" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#FFF">Linear(C→2C) + GELU + Linear(2C→C)</text>
  
  <!-- Residual Add -->
  <line x1="415" y1="830" x2="415" y2="860" stroke="#555" stroke-width="3"/>
  <circle cx="415" cy="885" r="25" fill="#9B59B6" stroke="#7D3C98" stroke-width="3"/>
  <text x="415" y="893" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#FFF">+</text>
  
  <!-- Output -->
  <line x1="415" y1="910" x2="415" y2="940" stroke="#555" stroke-width="3"/>
  <polygon points="407,933 423,933 415,948" fill="#555"/>
  <rect x="305" y="950" width="220" height="60" rx="10" fill="#F4D03F" stroke="#D4AC0D" stroke-width="3"/>
  <text x="415" y="990" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#333">Output</text>
  
  <!-- ==================== FUSE ARROW ==================== -->
  <rect x="820" y="440" width="160" height="120" rx="14" fill="#9B59B6" stroke="#7D3C98" stroke-width="3"/>
  <text x="900" y="495" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#FFF">FUSE</text>
  <text x="900" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#FFF">Reparameterize</text>
  
  <!-- Arrow -->
  <polygon points="980,500 1050,500 1050,475 1100,520 1050,565 1050,540 980,540" fill="#9B59B6"/>
  
  <!-- ==================== INFERENCE MODE (RIGHT) ==================== -->
  <rect x="1010" y="90" width="750" height="880" rx="16" fill="#FDEDEC" stroke="#E74C3C" stroke-width="3"/>
  <text x="1385" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#922B21">INFERENCE</text>
  
  <!-- Input -->
  <rect x="1275" y="170" width="220" height="60" rx="10" fill="#F4D03F" stroke="#D4AC0D" stroke-width="3"/>
  <text x="1385" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#333">Input (C)</text>
  
  <!-- Skip connection - RIGHT SIDE going down -->
  <line x1="1495" y1="200" x2="1710" y2="200" stroke="#9B59B6" stroke-width="4" stroke-dasharray="12,6"/>
  <line x1="1710" y1="200" x2="1710" y2="750" stroke="#9B59B6" stroke-width="4" stroke-dasharray="12,6"/>
  <line x1="1710" y1="750" x2="1410" y2="750" stroke="#9B59B6" stroke-width="4" stroke-dasharray="12,6"/>
  <polygon points="1415,742 1415,758 1400,750" fill="#9B59B6"/>
  <text x="1725" y="480" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#9B59B6" writing-mode="tb">Skip Connection</text>
  
  <!-- Down arrow -->
  <line x1="1385" y1="230" x2="1385" y2="275" stroke="#555" stroke-width="3"/>
  <polygon points="1377,268 1393,268 1385,283" fill="#555"/>
  
  <!-- Single fused conv box -->
  <rect x="1110" y="290" width="550" height="150" rx="14" fill="#FFF" stroke="#E74C3C" stroke-width="3"/>
  <text x="1385" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#922B21">Single Fused Convolution</text>
  <rect x="1160" y="365" width="450" height="55" rx="10" fill="#E74C3C" stroke="#B03A2E" stroke-width="3"/>
  <text x="1385" y="402" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#FFF">7×7 DWConv (Fused)</text>
  
  <!-- LayerNorm -->
  <line x1="1385" y1="440" x2="1385" y2="485" stroke="#555" stroke-width="3"/>
  <polygon points="1377,478 1393,478 1385,493" fill="#555"/>
  <rect x="1260" y="500" width="250" height="55" rx="10" fill="#1ABC9C" stroke="#16A085" stroke-width="3"/>
  <text x="1385" y="535" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#FFF">LayerNorm</text>
  
  <!-- MLP Box -->
  <rect x="1130" y="580" width="510" height="130" rx="12" fill="#D5F5E3" stroke="#27AE60" stroke-width="3"/>
  <text x="1385" y="615" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1E8449">Channel Mixer (MLP)</text>
  <line x1="1385" y1="555" x2="1385" y2="635" stroke="#555" stroke-width="3"/>
  <rect x="1180" y="635" width="410" height="45" rx="8" fill="#27AE60" stroke="#1E8449" stroke-width="2"/>
  <text x="1385" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#FFF">Linear(C→2C) + GELU + Linear(2C→C)</text>
  
  <!-- Residual Add -->
  <line x1="1385" y1="710" x2="1385" y2="740" stroke="#555" stroke-width="3"/>
  <circle cx="1385" cy="765" r="25" fill="#9B59B6" stroke="#7D3C98" stroke-width="3"/>
  <text x="1385" y="773" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#FFF">+</text>
  
  <!-- Output -->
  <line x1="1385" y1="790" x2="1385" y2="830" stroke="#555" stroke-width="3"/>
  <polygon points="1377,823 1393,823 1385,838" fill="#555"/>
  <rect x="1275" y="845" width="220" height="60" rx="10" fill="#F4D03F" stroke="#D4AC0D" stroke-width="3"/>
  <text x="1385" y="885" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#333">Output</text>
  
  <!-- Benefits -->
  <rect x="1160" y="925" width="450" height="50" rx="10" fill="#D5F5E3" stroke="#27AE60" stroke-width="2"/>
  <text x="1385" y="958" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1E8449">✓ Same output  •  ✓ 5× faster  •  ✓ Less memory</text>
  
  <!-- Legend at bottom center -->
  <rect x="550" y="945" width="700" height="50" rx="10" fill="#FFF" stroke="#CCC" stroke-width="2"/>
  <text x="610" y="978" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">Legend:</text>
  <rect x="700" y="960" width="35" height="22" rx="4" fill="#E74C3C"/>
  <text x="755" y="978" font-family="Arial, sans-serif" font-size="16" fill="#333">Conv</text>
  <rect x="810" y="960" width="35" height="22" rx="4" fill="#3498DB"/>
  <text x="865" y="978" font-family="Arial, sans-serif" font-size="16" fill="#333">BN</text>
  <rect x="910" y="960" width="35" height="22" rx="4" fill="#27AE60"/>
  <text x="970" y="978" font-family="Arial, sans-serif" font-size="16" fill="#333">MLP</text>
  <line x1="1030" y1="971" x2="1080" y2="971" stroke="#9B59B6" stroke-width="3" stroke-dasharray="6,3"/>
  <text x="1120" y="978" font-family="Arial, sans-serif" font-size="16" fill="#333">Skip</text>
  <circle cx="1180" cy="971" r="12" fill="#9B59B6"/>
  <text x="1215" y="978" font-family="Arial, sans-serif" font-size="16" fill="#333">Add</text>
  
</svg>
